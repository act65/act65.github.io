---
title: "A tutorial on ciphers"
subtitle: "and the Engima machine"
layout: post
permalink: /turing-vs-scherbius/enigma/
categories:
    - "tutorial"
---

Note: All the interactive ciphers only support lower case letters.


<style>
.small-input {
    width: 50px;
}

.large-input {
    width: 240px;
    font-size: 16px;
}

p {
    font-size: 16px;
}
</style>

## Cesar Cipher

A Cesar cipher is one of the simplest ciphers. You simply shift each letter by a fixed amount. If we are shifting by 2, then a$\to$c, b$\to$d, ..., z$\to$b.

This cipher can be generated by the cyclic group of integers modulo 26.

Enter a string to see it shifted by <input type="number" id="inputK" value="3" placeholder=3 class="small-input"> positions:

<div>
    <input type="text" id="inputTextCesar" placeholder="Enter text here"  onkeypress="checkEnterCesar(event)">
</div>
<p>Shifted Text: <span id="shiftedText"></span></p>

<script>
function checkEnterCesar(event) {
    if (event.key === 'Enter') {
        const input = document.getElementById('inputTextCesar').value;
        const shift = parseInt(document.getElementById('inputK').value);
        let shiftedText = shiftCipher(input, shift);
        document.getElementById('shiftedText').innerText = shiftedText;
    }
}

function shiftCipher(input, shift) {
    // assume only lower case
    const alphabet = 'abcdefghijklmnopqrstuvwxyz';

    let shiftedText = '';

    for (let i = 0; i < input.length; i++) {
        const char = input[i];
        const index = alphabet.indexOf(char);
        if (index === -1) {
            shiftedText += char;
            continue;
        } else {
            const newIndex = (index + shift) % 26;
            shiftedText += alphabet[newIndex];
        }
    }
    return shiftedText;
}

</script>



## Substitution cipher

A substitution cipher is the bijective mapping of the alphabet to itself. Or in other words, it is a permutation of the alphabet. Or in other other words, it is a reordering / scrabling of the alphabet.

This cipher can be generated by the symmetric group of integers modulo 26.


<div>
abcdefghijklmnopqrstuvwxyz<br>
<input type="text" id="inputSubstitution" placeholder="trialbcdefghjkmnopqrsuvwxyz" value="trialbcdefghjkmnopqrsuvwxyz" class="large-input">
</div>
Note. This substitution string must contain all 26 letters of the alphabet.

<div>
    <input type="text" id="inputTextSubstitution" placeholder="Enter text here"  onkeypress="checkEnterSubstitution(event)">
</div>


<p>Substituted Text: <span 
id="substitutedText"></span></p>

<script>
function checkEnterSubstitution(event) {
    if (event.key === 'Enter') {
        const input = document.getElementById('inputTextSubstitution').value;
        const substitution = document.getElementById('inputSubstitution').value;
        let result = substitutionCipher(input, substitution);
        document.getElementById('substitutedText').innerText = result;
    }
}

function substitutionCipher(input, substitution) {
    // assume only lower case
    const alphabet = 'abcdefghijklmnopqrstuvwxyz';

    // if first letter of substitution is 't', then 'a' is replaced with 't' 

    let result = '';

    for (let i = 0; i < input.length; i++) {
        const char = input[i];
        const index = substitution.indexOf(char);
        if (index === -1) {
            result += char;
            continue;
        } else {
            result += alphabet[index % 26];
        }
    }

    return result;
}
</script>


### A stepping substitution cipher

Here we take a substitution cipher and shift-by-one (via the Ceasar cipher above) the substitution string.

Each time we shift-by-one we call a 'step'.
A step is taken each time we press 'Enter'.

<div>
<input type="text" id="inputSteppingSubstitution" placeholder="trialbcdefghjkmnopqrsuvwxyz" value="trialbcdefghjkmnopqrsuvwxyz" class="large-input">
<p>Step:<span id="counter"></span></p>
</div>

<div>
    <input type="text" id="inputTextStepping" placeholder="Enter text here"  onkeypress="checkEnterStepping(event)">
</div>

<p>Stepping Substituted Text: <span id="steppingSubstitutedText"></span></p>

<script>
let counter = 0;
document.getElementById('counter').innerText = counter;
function checkEnterStepping(event) {
    if (event.key === 'Enter') {
        counter += 1;
        document.getElementById('counter').innerText = counter;

        const input = document.getElementById('inputTextStepping').value;
        const substitution = document.getElementById('inputSteppingSubstitution').value;
        let result = substitutionCipher(input, substitution);
        document.getElementById('steppingSubstitutedText').innerText = result;

        // update the substitution by shifting it by one
        let updated_sub = shiftCipher(substitution, 1);
        document.getElementById('inputSteppingSubstitution').value = updated_sub;
    }
}
</script>


## Engima

Is essentially three stepping substitution ciphers linked together.

![]({{ site.baseurl }}/assets/tvs/enigma-action.png)

Each 'rotor' is a stepping substitution cipher.  

The rate of stepping is different for each rotor.

- The first rotor steps every time a new letter is entered.
- The second rotor steps every 26 letters (or full rotation of the first rotor).
- The third rotor steps every 26$\times$26 letters (or full rotation of the second rotor).

Engima also comes with;

- a plugboard, which is a substitution cipher that is applied ???
- a reflector, is a substitution cipher that is applied inbetween the rotors.


#### The reflector

> The reflector ensured that Enigma would be self-reciprocal; thus, with two identically configured machines, a message could be encrypted on one and decrypted on the other, without the need for a bulky mechanism to switch between encryption and decryption modes. The reflector allowed a more compact design, but it also gave Enigma the property that no letter ever encrypted to itself. This was a severe cryptological flaw that was subsequently exploited by codebreakers.

***

So, setting up an Engima machine requires;
- choosing the types of rotor, 
- picking initial position of each rotor, 
- the plugboard and the reflector.

## Breaking a stepping substitution cipher

The first step is to identify the stepping rate. This can be done by looking at the frequency of letters in the cipher text.

Knowing the design of the cipher is a massive help!
<!-- could add a note about Marian Rejewski, Jerzy Różycki, and Henryk Zygalski -->




## Resources

- [Wikipedia](https://en.wikipedia.org/wiki/Enigma_machine)
